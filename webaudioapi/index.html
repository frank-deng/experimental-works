<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Try Web Audio API</title>
    <script type='text/javascript' src='mobile_logger.js'></script>
    <script type='text/javascript'>
window.addEventListener('load', function(){
	MobileLogger.bind(document.getElementById('logger_element'));
});
    </script>
	<style type='text/css'>
#logger_element{
	display:block;
	position:fixed;
	left:0;
	right:0;
	top:0;
	bottom:0;
	font-size:1em;
	line-height:1.1em;
	font-family:monospace;
	font-weight:normal;
	color:#FFF;
	background-color:#000;
	border-top: 1px solid #b3d8ff;
	margin:0;
	padding:0;
	z-index: 100;
	word-break:break-all;
}
	</style>
  </head>
  <body>
    <pre id='logger_element'></pre>
  </body>
  <script>
var audioCtx = new AudioContext();
var gainMaster = audioCtx.createGain();
gainMaster.connect(this.audioCtx.destination);
gainMaster.gain.setValueAtTime(0.1, this.audioCtx.currentTime);
var mixer = this.audioCtx.createChannelMerger(1);
mixer.connect(gainMaster);
var gain = audioCtx.createGain();
gain.gain.setValueAtTime(0.5, this.audioCtx.currentTime);
gain.connect(mixer);
var noiseNode = audioCtx.createScriptProcessor(4096, 1, 1);
noiseNode.connect(gain);
noiseDiv = 64;
noiseNode.addEventListener('audioprocess', (e)=>{
	var output = e.outputBuffer.getChannelData(0);
	var value = Math.random() * 2 - 1;
    for (var i = 0; i < e.outputBuffer.length; i++) {
    	if (0 == (i % noiseDiv)){
    		value = Math.random() * 2 - 1;
		}
        output[i] = value;
    }
});
    
document.body.addEventListener('click', function(){
	noiseNode.disconnect();
});
window.addEventListener('keydown', function(){
	noiseNode.disconnect();
});
  </script>
</html>
