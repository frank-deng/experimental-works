(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DrawPad"],{"26cd":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("canvas",{ref:"drawPad",staticClass:"drawPad",attrs:{width:t.width,height:t.height}})},r=[],i=(a("c5f6"),{props:{width:Number,height:Number},data:function(){return{drawing:!1,ctx:void 0,x0:void 0,y0:void 0}},watch:{drawing:function(t){t||(this.x0=this.y0=void 0)}},methods:{clear:function(){var t=this.$refs.drawPad,e=this.ctx;e.clearRect(0,0,t.width,t.height),this.drawing=!1},getCanvas:function(){return this.$refs.drawPad}},mounted:function(){var t=this,e=this.$refs.drawPad;this.ctx=e.getContext("2d");var a=function(e,a){if(t.ctx&&t.drawing){if(void 0!==t.x0&&void 0!==t.y0){var n=t.ctx;n.beginPath(),n.moveTo(t.x0,t.y0),n.lineTo(e,a),n.stroke()}t.x0=e,t.y0=a}};e.addEventListener("mousedown",(function(e){t.drawing=!0,t.$emit("click",e.offsetX,e.offsetY)})),e.addEventListener("mouseup",(function(e){t.drawing=!1})),e.addEventListener("mousemove",(function(t){a(t.offsetX,t.offsetY)})),e.addEventListener("touchstart",(function(e){t.drawing=!0})),e.addEventListener("touchend",(function(e){0==e.touches.length&&(t.drawing=!1)})),e.addEventListener("touchmove",(function(t){var n=e.getBoundingClientRect(),r=t.touches[0].clientX-n.left,i=t.touches[0].clientY-n.top;a(r,i)}))}}),o=i,s=(a("83c6"),a("2877")),c=Object(s["a"])(o,n,r,!1,null,"85062eea",null);e["default"]=c.exports},"27ca":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"car",style:t.carStyle},[n("img",{attrs:{src:a("60f7")}})])},r=[],i={data:function(){return{x:0,y:0,rotation:0,speed:1,steer:0}},computed:{carStyle:function(){return{left:"".concat(this.x,"px"),top:"".concat(this.y,"px"),transform:"rotate(".concat(this.rotation,"deg)")}}},methods:{place:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=t,this.y=e,this.rotation=a},setSpeed:function(t){this.speed=t},setSteer:function(t){this.steer=t},nextMove:function(){this.rotation+=this.steer,this.x+=this.speed*Math.sin(Math.PI/180*this.rotation),this.y-=this.speed*Math.cos(Math.PI/180*this.rotation)},lookGround:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,n=this.x+a*Math.sin(Math.PI/180*this.rotation),r=this.y-a*Math.cos(Math.PI/180*this.rotation),i=e.width,o=e.height,s=e.getContext("2d");s.clearRect(0,0,i,o),s.save(),s.translate(i/2,o/2),s.rotate(-Math.PI/180*this.rotation),s.drawImage(t,n-i/2,r-o/2,i,o,-i/2,-o/2,i,o),s.restore()}},mounted:function(){}},o=i,s=(a("f892"),a("2877")),c=Object(s["a"])(o,n,r,!1,null,"13337c47",null);e["default"]=c.exports},"41b3":function(t,e,a){},"4bb2":function(t,e,a){},"5dbc":function(t,e,a){var n=a("d3f4"),r=a("8b97").set;t.exports=function(t,e,a){var i,o=e.constructor;return o!==a&&"function"==typeof o&&(i=o.prototype)!==a.prototype&&n(i)&&r&&r(t,i),t}},"60f7":function(t,e,a){t.exports=a.p+"assets/img/car-in-top-view-512x512.png"},"83c6":function(t,e,a){"use strict";var n=a("41b3"),r=a.n(n);r.a},"8b97":function(t,e,a){var n=a("d3f4"),r=a("cb7c"),i=function(t,e){if(r(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=a("9b43")(Function.call,a("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,a){return i(t,a),e?t.__proto__=a:n(t,a),t}}({},!1):void 0),check:i}},"97f4":function(t,e,a){"use strict";var n=a("4bb2"),r=a.n(n);r.a},aa77:function(t,e,a){var n=a("5ca1"),r=a("be13"),i=a("79e5"),o=a("fdef"),s="["+o+"]",c="​",u=RegExp("^"+s+s+"*"),f=RegExp(s+s+"*$"),l=function(t,e,a){var r={},s=i((function(){return!!o[t]()||c[t]()!=c})),u=r[t]=s?e(d):o[t];a&&(r[a]=u),n(n.P+n.F*s,"String",r)},d=l.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(f,"")),t};t.exports=l},c3e1:function(t,e,a){},c5f6:function(t,e,a){"use strict";var n=a("7726"),r=a("69a8"),i=a("2d95"),o=a("5dbc"),s=a("6a99"),c=a("79e5"),u=a("9093").f,f=a("11e9").f,l=a("86cc").f,d=a("aa77").trim,h="Number",v=n[h],p=v,g=v.prototype,w=i(a("2aeb")(g))==h,y="trim"in String.prototype,b=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=y?e.trim():d(e,3);var a,n,r,i=e.charCodeAt(0);if(43===i||45===i){if(a=e.charCodeAt(2),88===a||120===a)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+e}for(var o,c=e.slice(2),u=0,f=c.length;u<f;u++)if(o=c.charCodeAt(u),o<48||o>r)return NaN;return parseInt(c,n)}}return+e};if(!v(" 0o1")||!v("0b1")||v("+0x1")){v=function(t){var e=arguments.length<1?0:t,a=this;return a instanceof v&&(w?c((function(){g.valueOf.call(a)})):i(a)!=h)?o(new p(b(e)),a,v):b(e)};for(var m,x=a("9e1e")?u(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;x.length>_;_++)r(p,m=x[_])&&!r(v,m)&&l(v,m,f(p,m));v.prototype=g,g.constructor=v,a("2aba")(n,h,v)}},ce5a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"drawPadContainer"},[a("drawPad",{ref:"drawPad",attrs:{width:320,height:320},on:{click:t.doPlaceCar}}),a("car",{ref:"car"})],1),a("div",{staticClass:"toolBox"},[a("span",[t._v("速度：")]),a("el-select",{staticClass:"speedSel",model:{value:t.delay,callback:function(e){t.delay=e},expression:"delay"}},[a("el-option",{attrs:{label:"慢",value:300}}),a("el-option",{attrs:{label:"中",value:100}}),a("el-option",{attrs:{label:"快",value:50}}),a("el-option",{attrs:{label:"很快",value:10}})],1),a("el-button-group",[a("el-button",{attrs:{size:"tiny"},on:{click:t.clearDrawPad}},[t._v("清空画板")]),a("el-button",{attrs:{size:"tiny",disabled:t.placeCar},on:{click:t.enterPlaceCarMode}},[t._v("放置小车")])],1)],1),a("div",{staticClass:"miscBox"},[a("p",[t._v("地面相机：\n      "),a("canvas",{ref:"groundCamera",staticClass:"groundCamera",attrs:{width:"64",height:"64"}})]),a("p",[t._v("分析结果："+t._s(t.analyzerResult))])])])},r=[],i=function(t,e){for(var a=0;a<t.width;a++)try{var n=t.data[4*(a*t.width+e)+3];if(n>16)return!0}catch(r){console.error(r);continue}return!1};function o(t){for(var e=t.getContext("2d"),a=t.width,n=t.height,r=e.getImageData(a/4,n/4,a/2,n/2),o=r.width,s=(r.height,null),c=0;c<o&&null===s;c++)i(r,c)&&(s=c/o*2-1);for(var u=null,f=o-1;f>=0&&null===u;f--)i(r,f)&&(u=f/o*2-1);e.rect(a/4,n/4,a/2,n/2);var l=e.strokeStyle;return e.strokeStyle="#FF0000",e.stroke(),e.strokeStyle=l,[s,u]}function s(t,e){var a=(t+e)/2;return 8*a}var c={components:{drawPad:a("26cd").default,car:a("27ca").default},data:function(){return{active:!0,analyzerResult:"",navigation:!1,delay:100,placeCar:!1}},watch:{navigation:function(t){t||this.$message({message:"小车导航丢失",type:"warning"})}},methods:{clearDrawPad:function(){this.$refs.drawPad.clear()},enterPlaceCarMode:function(){this.placeCar=!0},doPlaceCar:function(t,e){this.placeCar&&(this.$refs.car.place(t,e,0),this.placeCar=!1)}},mounted:function(){var t=this,e=this.$refs.drawPad.getCanvas();this.$refs.car.place(e.width/2,e.height/2,0);var a=function a(){if(t.active){setTimeout(a,t.delay),t.$refs.car.nextMove(),t.$refs.car.lookGround(e,t.$refs.groundCamera);var n=t.analyzerResult=o(t.$refs.groundCamera);null===n[0]||null===n[1]?(t.$refs.car.setSteer(0),t.$refs.car.setSpeed(0),t.navigation=!1):(t.$refs.car.setSteer(s(n[0],n[1])),t.$refs.car.setSpeed(1),t.navigation=!0)}};a()},beforeRouteLeave:function(t,e,a){this.active=!1,a()},beforeDestroy:function(){this.active=!1}},u=c,f=(a("97f4"),a("2877")),l=Object(f["a"])(u,n,r,!1,null,"3db8acd0",null);e["default"]=l.exports},f892:function(t,e,a){"use strict";var n=a("c3e1"),r=a.n(n);r.a},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);