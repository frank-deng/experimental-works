webpackJsonp([3],{D65k:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={},r=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,o="[^\\s]+",i=/\[([^]*?)\]/gm,s=function(){};function u(t,e){for(var n=[],a=0,r=t.length;a<r;a++)n.push(t[a].substr(0,e));return n}function d(t){return function(e,n,a){var r=a[t].indexOf(n.charAt(0).toUpperCase()+n.substr(1).toLowerCase());~r&&(e.month=r)}}function c(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],l=u(f,3),m=u(h,3);a.i18n={dayNamesShort:m,dayNames:h,monthNamesShort:l,monthNames:f,amPm:["am","pm"],DoFn:function(t){return t+["th","st","nd","rd"][t%10>3?0:(t-t%10!=10)*t%10]}};var g={D:function(t){return t.getDate()},DD:function(t){return c(t.getDate())},Do:function(t,e){return e.DoFn(t.getDate())},d:function(t){return t.getDay()},dd:function(t){return c(t.getDay())},ddd:function(t,e){return e.dayNamesShort[t.getDay()]},dddd:function(t,e){return e.dayNames[t.getDay()]},M:function(t){return t.getMonth()+1},MM:function(t){return c(t.getMonth()+1)},MMM:function(t,e){return e.monthNamesShort[t.getMonth()]},MMMM:function(t,e){return e.monthNames[t.getMonth()]},YY:function(t){return c(String(t.getFullYear()),4).substr(2)},YYYY:function(t){return c(t.getFullYear(),4)},h:function(t){return t.getHours()%12||12},hh:function(t){return c(t.getHours()%12||12)},H:function(t){return t.getHours()},HH:function(t){return c(t.getHours())},m:function(t){return t.getMinutes()},mm:function(t){return c(t.getMinutes())},s:function(t){return t.getSeconds()},ss:function(t){return c(t.getSeconds())},S:function(t){return Math.round(t.getMilliseconds()/100)},SS:function(t){return c(Math.round(t.getMilliseconds()/10),2)},SSS:function(t){return c(t.getMilliseconds(),3)},a:function(t,e){return t.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(t,e){return t.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(t){var e=t.getTimezoneOffset();return(e>0?"-":"+")+c(100*Math.floor(Math.abs(e)/60)+Math.abs(e)%60,4)}},v={D:["\\d\\d?",function(t,e){t.day=e}],Do:["\\d\\d?"+o,function(t,e){t.day=parseInt(e,10)}],M:["\\d\\d?",function(t,e){t.month=e-1}],YY:["\\d\\d?",function(t,e){var n=+(""+(new Date).getFullYear()).substr(0,2);t.year=""+(e>68?n-1:n)+e}],h:["\\d\\d?",function(t,e){t.hour=e}],m:["\\d\\d?",function(t,e){t.minute=e}],s:["\\d\\d?",function(t,e){t.second=e}],YYYY:["\\d{4}",function(t,e){t.year=e}],S:["\\d",function(t,e){t.millisecond=100*e}],SS:["\\d{2}",function(t,e){t.millisecond=10*e}],SSS:["\\d{3}",function(t,e){t.millisecond=e}],d:["\\d\\d?",s],ddd:[o,s],MMM:[o,d("monthNamesShort")],MMMM:[o,d("monthNames")],a:[o,function(t,e,n){var a=e.toLowerCase();a===n.amPm[0]?t.isPm=!1:a===n.amPm[1]&&(t.isPm=!0)}],ZZ:["[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z",function(t,e){var n,a=(e+"").match(/([+-]|\d\d)/gi);a&&(n=60*a[1]+parseInt(a[2],10),t.timezoneOffset="+"===a[0]?n:-n)}]};v.dd=v.d,v.dddd=v.ddd,v.DD=v.D,v.mm=v.m,v.hh=v.H=v.HH=v.h,v.MM=v.M,v.ss=v.s,v.A=v.a,a.masks={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},a.format=function(t,e,n){var o=n||a.i18n;if("number"==typeof t&&(t=new Date(t)),"[object Date]"!==Object.prototype.toString.call(t)||isNaN(t.getTime()))throw new Error("Invalid Date in fecha.format");var s=[];return(e=(e=(e=a.masks[e]||e||a.masks.default).replace(i,function(t,e){return s.push(e),"??"})).replace(r,function(e){return e in g?g[e](t,o):e.slice(1,e.length-1)})).replace(/\?\?/g,function(){return s.shift()})},a.parse=function(t,e,n){var o=n||a.i18n;if("string"!=typeof e)throw new Error("Invalid format in fecha.parse");if(e=a.masks[e]||e,t.length>1e3)return null;var i,s={},u=[],d=(i=e,i.replace(/[|\\{()[^$+*?.-]/g,"\\$&")).replace(r,function(t){if(v[t]){var e=v[t];return u.push(e[1]),"("+e[0]+")"}return t}),c=t.match(new RegExp(d,"i"));if(!c)return null;for(var h=1;h<c.length;h++)u[h-1](s,c[h],o);var f,l=new Date;return!0===s.isPm&&null!=s.hour&&12!=+s.hour?s.hour=+s.hour+12:!1===s.isPm&&12==+s.hour&&(s.hour=0),null!=s.timezoneOffset?(s.minute=+(s.minute||0)-+s.timezoneOffset,f=new Date(Date.UTC(s.year||l.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0))):f=new Date(s.year||l.getFullYear(),s.month||0,s.day||1,s.hour||0,s.minute||0,s.second||0,s.millisecond||0),f};var p=a,M=n("o1UL"),w=n.n(M);function D(t,e,n,a){if(n<=t&&a<=e)return{width:n,height:a};var r=n/a>t/e?n/t:a/e;return{width:n/r,height:a/r}}String.prototype.lpad=function(t,e){for(var n=this;n.length<e;)n=t+n;return n};var y={data:function(){return{stat:!1,reader:void 0}},methods:{onUploadFile:function(t){if(this.reader)return this.reader.readAsDataURL(t),this.stat="loading",!1},onSaveFile:function(t){var e=this.$refs.canvasImage.toDataURL("image/jpeg","image/jpeg"),n=document.createElement("a");n.href=e,n.download="IMG_"+p.format(new Date,"YYYYMMDD_HHMMSS.jpg"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(e)}},mounted:function(){var t=this,e=function(){var e=t.$refs.canvasImage,n=document.getElementById("image_area"),a=D(n.offsetWidth-2,n.offsetHeight-2,e.width,e.height);e.style.width=a.width+"px",e.style.height=a.height+"px"},n=this,a=new FileReader;this.reader=a;var r=new Image,o=new w.a;a.addEventListener("load",function(t){r.src=t.target.result}),r.addEventListener("load",function(){var t=D(1024,1024,this.width,this.height);n.$refs.canvasImage.width=t.width,n.$refs.canvasImage.height=t.height;var e=n.$refs.canvasImage.getContext("2d");e.drawImage(r,0,0,this.width,this.height,0,0,t.width,t.height);var a=n.$refs.canvasImage.width,i=n.$refs.canvasImage.height,s=e.getImageData(0,0,a,i);o.postMessage({imageData:s})}),o.addEventListener("message",function(t){t.data.message?alert(t.data.message):(n.$refs.canvasImage.getContext("2d").putImageData(t.data.imageData,0,0),n.stat="ok",e())}),r.addEventListener("error",function(){n.stat="failed"}),window.addEventListener("resize",e)}},Y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"KMeansMainFrame"},[n("div",{staticClass:"main-menu"},[n("el-upload",{staticClass:"uploadImage",attrs:{action:"",multiple:!1,limit:1,"show-file-list":!1,"before-upload":t.onUploadFile}},[n("el-button",{attrs:{type:"primary"}},[t._v("上传图片文件")])],1),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"ok"==t.stat,expression:'stat == "ok"'}],attrs:{type:"primary"},on:{click:t.onSaveFile}},[t._v("下载图片")])],1),t._v(" "),n("div",{staticClass:"image-area",attrs:{id:"image_area"}},[n("p",{directives:[{name:"show",rawName:"v-show",value:"loading"==t.stat,expression:'stat == "loading"'}],staticClass:"status"},[t._v("Processing...")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:"failed"==t.stat,expression:'stat == "failed"'}],staticClass:"status"},[t._v("Failed to load image.")]),t._v(" "),n("canvas",{directives:[{name:"show",rawName:"v-show",value:"ok"==t.stat,expression:'stat == "ok"'}],ref:"canvasImage",staticClass:"show-image",attrs:{width:"16",height:"16"}})])])},staticRenderFns:[]};var b=n("VU/8")(y,Y,!1,function(t){n("g6mh")},"data-v-0c0b5a01",null);e.default=b.exports},g6mh:function(t,e){},o1UL:function(t,e,n){t.exports=function(){return n("qDT4")('!function(t){var r={};function e(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}e.m=t,e.c=r,e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="./",e(e.s="o1UL")}({o1UL:function(t,r,e){"use strict";var a=function(t,r){this.targets=t.slice(),this.src=r};a.prototype={constructor:a,getMinDistance:function(t,r){for(var e,a=t.length,n=void 0,o=0;o<a;o++){var i=t[o],s=r[0]-i[0],u=r[1]-i[1],h=r[2]-i[2],f=s*s+u*u+h*h;(void 0===n||f<n)&&(n=f,e=o)}return e},getCentroids:function(t,r){for(var e=new Array(t.length),a=new Array,n=0;n<t.length;n++)a.push([0,0,0].slice()),e[n]=0;var o=r.length;for(n=0;n<o;n++){var i=r[n],s=this.getMinDistance(t,i);a[s][0]+=i[0],a[s][1]+=i[1],a[s][2]+=i[2],e[s]+=1}var u=0;for(n=0;n<a.length;n++){e[n]&&(a[n][0]/=e[n],a[n][1]/=e[n],a[n][2]/=e[n]);var h=a[n][0]-t[n][0],f=a[n][1]-t[n][1],c=a[n][2]-t[n][2];u+=h*h+f*f+c*c}return{result:a,delta:u/=3*a.length}},getOptimizedPalette(t,r){for(var e=void 0!==r?r:32,a=void 0!==t?t:.1,n=this.targets;e--;){var o=this.getCentroids(n,this.src);if(n=o.result,o.delta<a)break}for(var i=0;i<n.length;i++)for(var s=n[i],u=0;u<s.length;u++)n[i][u]=Math.round(s[u]);return n},getMap:function(t,r){for(var e=r.length,a=[],n=0;n<e;n++){var o=this.getMinDistance(t,r[n]);a.push(t[o].slice())}return a},getMapDither:function(t,r,e,a){for(var n=r.length,o=[],i=0;i<n;i++)o.push(r[i].slice());for(var s=0;s<a;s++)for(var u=0;u<e;u++){var h=o[s*e+u].slice(),f=t[this.getMinDistance(t,h)].slice();o[s*e+u]=f;var c,d=[h[0]-f[0],h[1]-f[1],h[2]-f[2]];if(u+1<e)(c=o[s*e+u+1])[0]=Math.round(c[0]+7*d[0]/16),c[1]=Math.round(c[1]+7*d[1]/16),c[2]=Math.round(c[2]+7*d[2]/16);if(u-1>0&&s+1<a)(c=o[(s+1)*e+u-1])[0]=Math.round(c[0]+3*d[0]/16),c[1]=Math.round(c[1]+3*d[1]/16),c[2]=Math.round(c[2]+3*d[2]/16);if(s+1<a)(c=o[(s+1)*e+u])[0]=Math.round(c[0]+5*d[0]/16),c[1]=Math.round(c[1]+5*d[1]/16),c[2]=Math.round(c[2]+5*d[2]/16);if(u+1<e&&s+1<a)(c=o[(s+1)*e+u+1])[0]=Math.round(c[0]+1*d[0]/16),c[1]=Math.round(c[1]+1*d[1]/16),c[2]=Math.round(c[2]+1*d[2]/16)}return o},process:function(t,r,e,a){return this.getMap(this.getOptimizedPalette(e,a),this.src,t,r)}};for(var n=[],o=0;o<27;o++){let t=[0,127,255];n.push([t[Math.floor(o/9)%3],t[Math.floor(o/3)%3],t[o%3]])}self.addEventListener("message",function(t){var r=t.data.imageData,e=function(t){for(var r=new Array,e=t.width*t.height,a=t.data,n=0;n<e;n++)r.push([a[4*n],a[4*n+1],a[4*n+2]]);return r}(t.data.imageData),o=new a(n,e).process(r.width,r.height);!function(t,r){for(var e=t.width*t.height,a=0;a<e;a++)t.data[4*a]=r[a][0],t.data[4*a+1]=r[a][1],t.data[4*a+2]=r[a][2]}(t.data.imageData,o),self.postMessage({imageData:t.data.imageData})})}});',null)}},qDT4:function(t,e,n){"use strict";var a=window.URL||window.webkitURL;t.exports=function(t,e){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(t),n=n.getBlob()}catch(e){n=new Blob([t])}return new Worker(a.createObjectURL(n))}catch(e){return new Worker("data:application/javascript,"+encodeURIComponent(t))}}catch(t){if(!e)throw Error("Inline worker is not supported");return new Worker(e)}}}});