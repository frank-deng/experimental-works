webpackJsonp([1],{"4A/p":function(t,e,a){t.exports=a.p+"static/img/car-in-top-view-512x512.f89abb7.png"},FF3r:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={data:function(){return{x:0,y:0,rotation:0,speed:1,steer:0}},computed:{carStyle:function(){return{left:this.x+"px",top:this.y+"px",transform:"rotate("+this.rotation+"deg)"}}},methods:{place:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=t,this.y=e,this.rotation=a},setSpeed:function(t){this.speed=t},setSteer:function(t){this.steer=t},nextMove:function(){this.rotation+=this.steer,this.x+=this.speed*Math.sin(Math.PI/180*this.rotation),this.y-=this.speed*Math.cos(Math.PI/180*this.rotation)},lookGround:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,n=this.x+a*Math.sin(Math.PI/180*this.rotation),r=this.y-a*Math.cos(Math.PI/180*this.rotation),i=e.width,s=e.height,o=e.getContext("2d");o.clearRect(0,0,i,s),o.save(),o.translate(i/2,s/2),o.rotate(-Math.PI/180*this.rotation),o.drawImage(t,n-i/2,r-s/2,i,s,-i/2,-s/2,i,s),o.restore()}},mounted:function(){}},r={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"car",style:this.carStyle},[e("img",{attrs:{src:a("4A/p")}})])},staticRenderFns:[]};var i=a("VU/8")(n,r,!1,function(t){a("MNGv")},"data-v-3ab9dbde",null);e.default=i.exports},Kjsf:function(t,e){},MNGv:function(t,e){},SK4Q:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={props:{width:Number,height:Number},data:function(){return{drawing:!1,ctx:void 0,x0:void 0,y0:void 0}},watch:{drawing:function(t){t||(this.x0=this.y0=void 0)}},methods:{clear:function(){var t=this.$refs.drawPad;this.ctx.clearRect(0,0,t.width,t.height),this.drawing=!1},getCanvas:function(){return this.$refs.drawPad}},mounted:function(){var t=this,e=this.$refs.drawPad;this.ctx=e.getContext("2d");var a=function(e,a){if(t.ctx&&t.drawing){if(void 0!==t.x0&&void 0!==t.y0){var n=t.ctx;n.beginPath(),n.moveTo(t.x0,t.y0),n.lineTo(e,a),n.stroke()}t.x0=e,t.y0=a}};e.addEventListener("mousedown",function(e){t.drawing=!0,t.$emit("click",e.offsetX,e.offsetY)}),e.addEventListener("mouseup",function(e){t.drawing=!1}),e.addEventListener("mousemove",function(t){a(t.offsetX,t.offsetY)}),e.addEventListener("touchstart",function(e){t.drawing=!0}),e.addEventListener("touchend",function(e){0==e.touches.length&&(t.drawing=!1)}),e.addEventListener("touchmove",function(t){var n=e.getBoundingClientRect(),r=t.touches[0].clientX-n.left,i=t.touches[0].clientY-n.top;a(r,i)})}},r={render:function(){var t=this.$createElement;return(this._self._c||t)("canvas",{ref:"drawPad",staticClass:"drawPad",attrs:{width:this.width,height:this.height}})},staticRenderFns:[]};var i=a("VU/8")(n,r,!1,function(t){a("Kjsf")},"data-v-d4db6b56",null);e.default=i.exports},gybU:function(t,e){},i6yL:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){for(var a=0;a<t.width;a++)try{if(t.data[4*(a*t.width+e)+3]>16)return!0}catch(t){console.error(t);continue}return!1};var r={components:{drawPad:a("SK4Q").default,car:a("FF3r").default},data:function(){return{active:!0,analyzerResult:"",navigation:!1,delay:100,placeCar:!1}},watch:{navigation:function(t){t||this.$message({message:"小车导航丢失",type:"warning"})}},methods:{clearDrawPad:function(){this.$refs.drawPad.clear()},enterPlaceCarMode:function(){this.placeCar=!0},doPlaceCar:function(t,e){this.placeCar&&(this.$refs.car.place(t,e,0),this.placeCar=!1)}},mounted:function(){var t=this,e=this.$refs.drawPad.getCanvas();this.$refs.car.place(e.width/2,e.height/2,0);!function a(){if(t.active){setTimeout(a,t.delay),t.$refs.car.nextMove(),t.$refs.car.lookGround(e,t.$refs.groundCamera);var r,i,s=t.analyzerResult=function(t){for(var e=t.getContext("2d"),a=t.width,r=t.height,i=e.getImageData(a/4,r/4,a/2,r/2),s=i.width,o=(i.height,null),c=0;c<s&&null===o;c++)n(i,c)&&(o=c/s*2-1);for(var d=null,l=s-1;l>=0&&null===d;l--)n(i,l)&&(d=l/s*2-1);e.rect(a/4,r/4,a/2,r/2);var u=e.strokeStyle;return e.strokeStyle="#FF0000",e.stroke(),e.strokeStyle=u,[o,d]}(t.$refs.groundCamera);null===s[0]||null===s[1]?(t.$refs.car.setSteer(0),t.$refs.car.setSpeed(0),t.navigation=!1):(t.$refs.car.setSteer((r=s[0],i=s[1],(r+i)/2*8)),t.$refs.car.setSpeed(1),t.navigation=!0)}}()},beforeRouteLeave:function(t,e,a){this.active=!1,a()},beforeDestroy:function(){this.active=!1}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"drawPadContainer"},[a("drawPad",{ref:"drawPad",attrs:{width:320,height:320},on:{click:t.doPlaceCar}}),t._v(" "),a("car",{ref:"car"})],1),t._v(" "),a("div",{staticClass:"toolBox"},[a("span",[t._v("速度：")]),a("el-select",{staticClass:"speedSel",model:{value:t.delay,callback:function(e){t.delay=e},expression:"delay"}},[a("el-option",{attrs:{label:"慢",value:300}}),t._v(" "),a("el-option",{attrs:{label:"中",value:100}}),t._v(" "),a("el-option",{attrs:{label:"快",value:50}}),t._v(" "),a("el-option",{attrs:{label:"很快",value:10}})],1),t._v(" "),a("el-button-group",[a("el-button",{attrs:{size:"tiny"},on:{click:t.clearDrawPad}},[t._v("清空画板")]),t._v(" "),a("el-button",{attrs:{size:"tiny",disabled:t.placeCar},on:{click:t.enterPlaceCarMode}},[t._v("放置小车")])],1)],1),t._v(" "),a("div",{staticClass:"miscBox"},[a("p",[t._v("地面相机：\n      "),a("canvas",{ref:"groundCamera",staticClass:"groundCamera",attrs:{width:"64",height:"64"}})]),t._v(" "),a("p",[t._v("分析结果："+t._s(t.analyzerResult))])])])},staticRenderFns:[]};var s=a("VU/8")(r,i,!1,function(t){a("gybU")},"data-v-28c91e74",null);e.default=s.exports}});